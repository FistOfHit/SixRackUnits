<h1 id="september-2024">September 2024</h1>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/1.jpeg" alt=""></p>
<p><em>Is this what we imagine on-chip free-space optics might look like?</em></p>
<p> <strong>This month&#39;s updates:</strong></p>
<ul>
<li><p>Nvidia B100/200&#39;s not delayed? How TSMC and Nvidia overcame a major setback</p>
</li>
<li><p>Intel concedes on training, focuses on AI inference for their next GPUs/XPUs</p>
</li>
<li><p>SambaNova using a single rack to achieve the fastest LLM inference speeds to date</p>
</li>
<li><p>Tesla develops its own transport protocol for its 100,000 GPU supercomputer</p>
</li>
<li><p>The race towards HBM4, a tie between Samsung and SK Hynix, Micron catching up</p>
<p><strong>One-pagers:</strong></p>
</li>
<li><p>LPDDR5X</p>
</li>
<li><p>OSFP</p>
</li>
<li><p>FLOPs</p>
</li>
</ul>
<hr>
<h1 id="this-month-s-updates-">This month&#39;s updates:</h1>
<h2 id="nvidia-b100-200s-not-delayed-">Nvidia B100/200s not delayed?</h2>
<p> <em>Last time we reported that Nvidia&#39;s B100/200 cards would be delayed coming into market, up until 2Q2025 at the latest from their original 4Q2024 planned shipments, but <a href="https://www.trendforce.com/news/2024/09/10/news-nvidias-blackwell-overcomes-delays-as-gb200-reportedly-sets-for-december-mass-production/">it appears that things are back on track</a>, with TSMC and Nvidia overcoming manufacturing issues and picking up pace to meet their contracts (almost)</em></p>
<p>The roadmap as shown below details their plans for their other technologies such as their switch ASICs. The <a href="https://www.nvidia.com/en-gb/networking/products/infiniband/quantum-x800/">Quantum</a> and <a href="https://nvdam.widen.net/s/xfmlcbklg5/ethernet-solution-overview-spectrum-x800-gtcspring24-3175614">Spectrum</a> series supporting up to 144 and 64 ports at 800Gb/s respectively, with a 512-radix version of the spectrum coming in early 2025 hopefully, and the <a href="https://resources.nvidia.com/en-us-accelerated-networking-resource-library/connectx-datasheet-c">CX8 SuperNIC</a> to support these bandwidths should, together, enable networks that will saturate the GPUs of the near future.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/2.png" alt=""></p>
<p><em>Source: Nvidia</em></p>
<p>With individual orders being in the $100&#39;s of millions from some of their customers, Nvidia has had a lot of pressure to deliver their GPUs on time, but with the recent issues in TSMC&#39;s next-gen manufacturing process potentially delaying the production of these devices by months, things were looking bleak.</p>
<p>However, it appears that <a href="https://www.trendforce.com/news/2024/09/10/news-nvidias-blackwell-overcomes-delays-as-gb200-reportedly-sets-for-december-mass-production/">the issue has been solved</a>, with Nvidia and TSMC making modifications and falling back to a <a href="https://www.trendforce.com/news/2024/03/21/news-blackwell-enters-the-scene-a-closer-look-at-tsmcs-cowos-branch/">more mature and tested semiconductor manufacturing technology</a> to meet deadlines. <a href="https://www.tomshardware.com/pc-components/gpus/nvidia-will-reportedly-start-blackwell-server-deliveries-in-early-december-the-first-servers-will-go-to-microsoft">The first products out will be their racks</a>, the <a href="https://www.semianalysis.com/i/147346718/architecture-of-the-mgx-gba-ultra-nvl">NVL36 and NVL72, ultra dense NVLink connected setups</a> that are designed to fit into modern datacenters with high power densities and liquid cooling. <a href="https://www.trendforce.com/presscenter/news/20240807-12244.html">The B200A</a> (lower power, lower cost version) and corresponding 36 and 72 GPU racks, all air-cooled, are still expected to ship as originally planned.</p>
<h2 id="intel-concedes-on-ai-training">Intel concedes on AI training</h2>
<p> <em><a href="https://www.intc.com/news-events/press-releases/detail/1710/a-message-from-intel-ceo-pat-gelsinger-to-employees#:~:text=We%20must%20continue%20acting%20with,to%20Intel%20customers%20and%20partners.">A letter from Intel CEO</a>, Pat Gelsinger, states that Intel&#39;s XPU lineup will be focusing on AI inference only, conceding AI training to its competitors. Whether this is yet another failure on Intel&#39;s part to deliver, or a strategic move to focus on their strengths, the Intel Falcon shores is still a capable AI accelerator.</em></p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/3.png" alt=""></p>
<p><em>Source: Intel - A TDP of 1500W, carrying 288GB of HBM3, 9.8TB/s of bandwidth between device memory and compute, with x86 (of course) cores on chip.</em></p>
<p>After the recent failures of the company, Intel has confirmed that its planned Falcon shores XPU (CPU + GPU on the same chip) will now be a GPU only and will focus on AI inference instead of training. Whilst it was <a href="https://www.tomshardware.com/news/intel-explains-falcon-shores-redefinition-shares-roadmap-and-first-details">known as far back as 2Q2023</a> that Falcon shores, Intel&#39;s own successor to the Habana Gaudi 3, will no longer be a CPU and GPU on the same chip, only recently has it been made clear that <a href="https://www.hpcwire.com/2024/09/17/intels-falcon-shores-future-looks-bleak-as-it-concedes-ai-training-to-gpu-rivals/">Intel no longer plans to optimise its GPU and tech stack for AI training</a>.</p>
<p>Not supporting AI training workloads will serve more than one purpose: designing the chip will be easier, the software stack will be easier to develop, and the cost of production, including labour and manufacturing, will likely be significantly lower.</p>
<p>The TDP (thermal design power), or maximum amount of heat the device can output during typical workloads, is stated to be 1500W, 50% more than even the Nvidia B200. Such a design will <a href="https://www.guru3d.com/story/intel-falcon-shores-processor-to-consume-1500w-exceeding-nvidia-b200-power-usage/#:~:text=Intel%20has%20confirmed%20that%20its,which%20draws%20up%20to%201200W.">require a huge leap in socketing technology</a>, far exceeding the wattage that Nvidia&#39;s SXM socketing tech stack must support. In addition, using these devices will force any datacentre to have state of the art liquid cooling solutions, which as we have seen, is not an easy ask.</p>
<h2 id="sambanova-s-llm-inference-speeds">SambaNova&#39;s LLM inference speeds</h2>
<p> <em>Despite providing little detail on the connectivity and power details of their AI inference system, SambaNova systems and their SN40L AI accelerator are still very interesting to study. <a href="https://sambanova.ai/blog/sn40l-chip-best-inference-solution">AI inferencing</a> and <a href="https://www.arabnews.com/node/2571362/business-economy">breaking into the Middle east&#39;s growing AI hardware market</a> are both tasks that SambaNova are setting records in.</em></p>
<p>SambaNova systems, a <a href="https://sambanova.ai/investors-funding">SoftBank and BlackRock funded</a> AI accelerator systems designer has been making headlines in the AI inference space with its <a href="https://www.theregister.com/2024/09/10/sambanovas_inference_cloud/">record-breaking LLM inference speeds</a>. Most companies who design and integrate systems that compete with the likes of Intel, Nvidia, AMD and others usually use the open-source, open-weight (anyone can download and modify) <a href="https://www.llama.com/">Llama LLMs from Meta</a>, since they can optimise and inference the models in any way they like to suit their own devices and setups. SambaNova has just reported speeds of up to 132 Tokens (for the purposes of this article, words)/second, for the 405 Billion parameter Llama 3.1 model.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/4.png" alt=""></p>
<p><em>Source: SambaNova</em></p>
<p>To put that into context, AWS and Azure both, likely serving the models on Nvidia H100s, <a href="https://www.theregister.com/2024/09/10/sambanovas_inference_cloud/">offer speeds of 13 Tokens/second</a>. What&#39;s even more surprising is how space and energy efficient their system is, with the 16 x SN40L RDU (reconfigurable data unit, their AI accelerator) rack being sufficient to run a model this size.</p>
<p><a href="https://sambanova.ai/technology/sn40l-rdu-ai-chip">The RDU</a> comes in at 51 Billion transistors per piece, compared to the H100s 80 Billion, and has 64 GB of HBM3, compared to the H100s 80/96 GB. Each of the 8 trays in the rack support 2 RDUs with an additional 1.5 TB of DDR5 RAM (<a href="https://www.nextplatform.com/2023/09/20/sambanova-tackles-generative-ai-with-new-chip-and-new-approach/">1</a>). The real secret through, of device interconnectivity, whether it be via copper like Nvidia&#39;s NVLink or via optics like an Ethernet network, is kept from the public.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/5.png" alt=""></p>
<p><em>Source: SambaNova</em></p>
<h2 id="tesla-s-transport-protocol-over-ethernet">Tesla&#39;s transport protocol over Ethernet</h2>
<p> <em>Indeed, every organisation inherits its behaviours from its leader, and the documentation for Tesla&#39;s new open-source transport protocol designed to run over an ethernet network, named the Tesla transport protocol over Ethernet (TTPoE), <a href="https://github.com/teslamotors/ttpoe?tab=readme-ov-file#introduction">reads like one of its CEOs tweets/posts on X</a>.</em></p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/6.jpeg" alt=""></p>
<p><em>Source: ServeTheHome</em></p>
<p><a href="https://hotchips.org/">At HotChips 2024</a>, Tesla displayed a liquid cooled <a href="https://www.datacenterdynamics.com/en/news/tesla-details-dojo-supercomputer-reveals-dojo-d1-chip-and-training-tile-module/">Dojo training tile</a>, connected to NICs and a network, all on a desk at the conference. Whilst this was an impressive and easy to understand display, what was arguably even more impressive was their announcement of their own <a href="https://chipsandcheese.com/2024/08/27/teslas-ttpoe-at-hot-chips-2024-replacing-tcp-for-low-latency-applications/">high-performing open-source transport protocol designed to run through standard ethernet switches</a>, or the TTPoE.</p>
<p>Tesla would know just as well as Google, Microsoft and Meta about how difficult and slow it can get to scale ethernet networks to 10s or 100&#39;s of thousands of endpoints, but unlike the other tech giants, Tesla has decided to open source its transport layer protocol and has designed it to run only over Ethernet, allowing users to avoid InfiniBand whilst seeing the latency reductions and bandwidth increases provided by this new protocol.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/7.png" alt=""></p>
<p><em>Source: Tesla</em></p>
<p><a href="https://www.servethehome.com/tesla-dojo-exa-scale-lossy-ai-network-using-the-tesla-transport-protocol-over-ethernet-ttpoe/">TTPoE improves on TCP for AI and HPC workloads</a> by removing excessive acknowledgements like those at connection closings, removing unnecessary waits, and changing how lost packets and re-transmission is handled in hardware, among many other new features. However, it keeps TCP&#39;s endpoint managed congestion control and doesn&#39;t require &quot;smart&quot; NICs, emphasising clear differences to InfiniBand.</p>
<h2 id="the-race-towards-hbm4">The race towards HBM4</h2>
<p> _<a href="https://en.wikipedia.org/wiki/High_Bandwidth_Memory">High bandwidth memory</a>, or HBM is the solution that industry has come up with for keeping up with the incredible increase in compute power from the higher end GPUs, but this has led to a close race between two competitors. What is HBM, why do we need it, and who will win this race? We answer two of these questions._</p>
<p>With regular DRAM, you have one die (or block of silicon) with the transistors and capacitors for storing memory, but since <a href="https://medium.com/riselab/ai-and-memory-wall-2cb4265cb0b8">compute has been scaling faster than memory</a> for decades, we have had to stack multiple (specialised) DRAM dies vertically (diagram below) and link them up to access all the dies at once, providing more bandwidth per chip area from memory modules. Currently, the latest <a href="https://www.trendforce.com/news/2024/07/10/news-samsung-sk-hynix-and-micron-ramp-up-hbm-production-reportedly-doubling-output-next-year/">Nvidia H1/200s and AMD MI300X/A ship with HBM3e and HBM3 respectively</a>, third generation HBM modules. Towards the end of 2024 and 2025/6, we will see 12 high stacks for HBM3e and <a href="https://www.trendforce.com/news/2024/07/15/news-jedec-releases-new-hbm4-spec-as-memory-giants-gear-up-to-take-the-lead/">possibly 16 or more for HBM4</a>, reaching ever higher volumes and bandwidths.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/8.png" alt=""></p>
<p><em>Source: Rambus</em></p>
<p>It&#39;s clear that at least until 2025/6, this will be a <a href="https://www.trendforce.com/news/2024/07/10/news-samsung-sk-hynix-and-micron-ramp-up-hbm-production-reportedly-doubling-output-next-year/">two-horse race between Samsung and SK Hynix</a>, both Korean memory manufacturers, with <a href="https://www.chosun.com/english/industry-en/2024/07/01/QHQ7B7BC3VDZTJK6I57ROKLHLE/">Micron picking up</a> both market share and pace from 2H2024 onwards.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/9.png" alt=""></p>
<p><em>Source: TrendForce</em></p>
<hr>
<h1 id="one-pagers-">One-pagers:</h1>
<h2 id="lpddr5x">LPDDR5x</h2>
<p> <em>With IBM, Google, Amazon and many others pushing for gains in efficiency rather than raw performance, energy efficient AI hardware is becoming the popular choice for many datacentre users. Low power double data rate (LPDDR) memory is a key component this drive towards effciency.</em></p>
<p>Whilst competitors in the large AI model training space like Nvidia and AMD head towards higher and higher power usage, others are focusing on the AI inference market, where budgets are defined by opex and service utilisation. Here, competing with the power-hungry memory used in training accelerators is key, and one of the key components in this drive is LPDDR, generation 5x.</p>
<p>Let&#39;s break down what this means:</p>
<ul>
<li><p>LP: Low Power – This is achieved by a lower effective operating power due to variability in the voltage required to refresh cell states, as well as smarter power usage in idle states and finer grain control over which parts of the memory are consuming power at a given time</p>
</li>
<li><p>DDR: Double Data Rate – A standard feature of DRAM (Dynamic random-access memory, or just main memory), where the rate at which data can be transferred is doubled by using by using both the rise and fall of each clock cycle (or tick, like in a clock) to transfer data</p>
</li>
<li><p>5x: Generation 5, Enhanced (&quot;x&quot; sounds better than &quot;e&quot; I suppose)</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/10.png" alt=""></p>
<p><em>Source: Samsung</em></p>
<p>LPDDR must be soldered directly onto the mainboard, resulting in an inability to hot-swap (replace the physical hardware during operation) modules or change the volume, but for mobile devices and AI accelerators, this has been the case even with regular DRAM. The benefits far outweigh the inconveniences and additional costs through, with lower power usage, lower latency, and higher bandwidth.</p>
<h2 id="osfp">OSFP</h2>
<p> <em>Despite enabling the generative AI explosion, networking doesn&#39;t get the same media treatment that compute does, with GPUs taking the spotlight. Connecting multiple GPU nodes requires fast networks, and hence fast transceivers. Octal Small Form factor Pluggables (OSFP) are the latest in this trend.</em></p>
<p>Connecting multiple servers together requires a network, and hence network cables. Whether its copper (not widely used anymore) or optical, there needs to be a component that can connect to a cable and then plug into a switch/adapter, whilst mediating physical signal quality and modulation, and also the conversion between electrical/optical signals in wire/fibre and electrical signals understandable by a switch or a server.</p>
<p>SFPs have been in use for a while now, but more recently the need for extremely high bandwidth interconnect between servers has exploded due to the popularisation of training and inferencing very large generative AI models. Prior to that, users who ran very large workloads like weather forecasting or structural stress analysis could balance their compute and memory requirements with the 25Gb or even 10Gb network bandwidths, but with AI, the memory demand is so much greater that the technology needed to transfer data between servers has had to evolve incredibly fast to keep up. In addition, with GPUs like A100s and H100s, the compute speeds have increased rapidly, meaning that memory speeds are now more of a bottleneck than ever.</p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/11.png" alt=""></p>
<p><em>Source: Ascent Optics</em></p>
<p>A 400G (4x100G) 8-lane optical transceiver (transmitter and receiver pair per lane) unit designed to be plugged into multi-port network switches, hence requiring a small form factor. Within this body, OSFPs have to fit their connectors, signal converters, heat sinks and more. The distances supported by optical connections using OSFPs can be up to 10KM, allowing for very long-range optical connections between datacentres or multiple facilities.</p>
<h2 id="flops">FLOPs</h2>
<p> <em>How do you compare different compute hardware? There are a few key metrics depending on the purpose of the device, but for CPUs and GPUs, a key metric is the number of floating-point operations per second, or how fast you can add and multiply lots of numbers. But this can be misleading.</em></p>
<p><img src="https://raw.githubusercontent.com/FistOfHit/SixRackUnits/refs/heads/main/newsletters/2024/september_2024/images/12.png" alt=""></p>
<p><em>Estimated</em></p>
<p>Looking at these numbers without any context or purpose is meaningless and says very little about any of the devices. For example:</p>
<ul>
<li><p>Nvidia&#39;s H100 reaches ~2000 Tera FLOPs, but comes with some small print: only with sparsity, or where most of the data is effectively zero</p>
</li>
<li><p>Google&#39;s TPUv5e looks a lot worse off, but they advertise for dense matrices (most of the data is not zero) and the power draw of a TPUv4 is less than a quarter that of the H100</p>
</li>
<li><p>AMD&#39;s EPYC 7702 CPU doesn&#39;t even advertise FLOPs so it had to be estimated, since what CPUs do is much more complicated and flexible than what GPUs do</p>
</li>
<li><p>Cerebras&#39; WSE-3 looks amazing, apart from when you learn its many, many times the size and cost of a H100 GPU and is much harder to program/optimise for</p>
</li>
</ul>
